<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Building a calibrated gene tree with BEAST 2.7 | </title> <meta name="author" content="Pedro P. G. Taucci"> <meta name="description" content="A step-by-step beginner's guide"> <meta name="keywords" content="herpetology, amphibians, reptiles, systematics, phylogeography"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/logos/favicon.svg?964134e30467bb50cb172b62f5c095b4"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://pedrotaucce.github.io/blog/2024/calibrated_gene_tree/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand" href="/"> <img id="logo-img" src="/assets/img/logos/logo_verde.png" alt="Logo" style="width: 100px; height: auto;"> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Home </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">People </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <script>document.addEventListener("DOMContentLoaded",function(){function t(){const t=document.documentElement.getAttribute("data-theme");e.src="dark"===t?"/assets/img/logos/logo_laranja.png":"/assets/img/logos/logo_verde.png"}const e=document.getElementById("logo-img");new MutationObserver(t).observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),t()});</script> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Building a calibrated gene tree with BEAST 2.7</h1> <p class="post-meta"> Created in December 02, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/beast"> <i class="fa-solid fa-hashtag fa-sm"></i> BEAST</a>   <a href="/blog/tag/dating"> <i class="fa-solid fa-hashtag fa-sm"></i> Dating</a>   <a href="/blog/tag/ultrametrictree"> <i class="fa-solid fa-hashtag fa-sm"></i> UltrametricTree</a>   <a href="/blog/tag/molecularclock"> <i class="fa-solid fa-hashtag fa-sm"></i> MolecularClock</a>   ·   <a href="/blog/category/phylogenetics"> <i class="fa-solid fa-tag fa-sm"></i> Phylogenetics</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Since our blog is called <strong>The BEAST</strong>, it is only fair that we debut our posts by discussing <strong>Bayesian Evolutionary Analysis Sampling Trees</strong>, or simply <a href="https://www.beast2.org" rel="external nofollow noopener" target="_blank">BEAST</a> (<a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1006650" rel="external nofollow noopener" target="_blank">Bouckaert et al. 2019)</a>, one of the most widespread molecular phylogenetic software packages. Although there are many great <a href="https://www.beast2.org/tutorials/" rel="external nofollow noopener" target="_blank">tutorials</a> on the BEAST2 website and even an entire site dedicated to a yearly course taught by some of the developers (see <a href="https://taming-the-beast.org/tutorials/" rel="external nofollow noopener" target="_blank">Taming the BEAST</a>), I believe that a step-by-step guide aimed at new users is always welcome.</p> <p>In Bayesian phylogenetic analyses, hypotheses (<em>i.e.</em>, the tree and its parameters) are generated based on a data matrix, an assumed model of nucleotide evolution, and various priors. We will revisit all of this shortly, but for now, we will need a <a href="/assets/files/p_rupicola.fasta">molecular matrix</a>. For this, we will use the 16S mtDNA matrix from the description of <em>Pristimantis rupicola</em> (Anura: Brachycephaloidea), from <a href="https://bioone.org/journals/journal-of-herpetology/volume-54/issue-2/19-114/A-New-Rupicolous-Species-of-the-Pristimantis-conspicillatus-Group-Anura/10.1670/19-114.short" rel="external nofollow noopener" target="_blank">Taucce et al. (2020)</a>. I will assume you are familiar with retrieving sequences from <a href="https://www.ncbi.nlm.nih.gov/genbank/" rel="external nofollow noopener" target="_blank">GenBank</a> and aligning them, but we will cover these topics in future posts.</p> <p><strong>BEAST2</strong> interprets XML files, and to build one, we will use the <strong>BEAUti</strong> app, which is part of BEAST software package. First, we will load our molecular matrix by going to <code>File &gt; Import Alignment</code>. BEAUti will prompt us to specify the type of data we have, and we will select “nucleotide” (<a href="#fig1">Fig. 1</a>).</p> <div class="image-container mt-3"> <figure id="fig1"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2024-10-06/fig1.png" sizes="95vw"></source> <img src="/assets/img/posts/2024-10-06/fig1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption style="font-size: 0.9em; text-align: center;"><strong>Figure 1:</strong> BEAUti screen after you have loaded the molecular matrix.</figcaption> </figure> </div> <p>We will leave the “Tip Dates” panel as it is and move on to the “Site Model” panel (<a href="#fig2">Fig. 2</a>). At this stage, we need to select a nucleotide substitution model for our data. While there are several software packages available for this task, BEAST conveniently includes an inbuilt package that will infer the best-fitting nucleotide substitution model simultaneously with the phylogenetic tree inference: <strong>bModelTest</strong> (<a href="https://bmcecolevol.biomedcentral.com/articles/10.1186/s12862-017-0890-6" rel="external nofollow noopener" target="_blank">Bouckaert &amp; Drummond, 2017</a>). If the <code>BEAST Model Test</code> option is not available, you may need to install it by navigating to <code>File &gt; Manage Packages</code>. With that in place, we are now ready to proceed to the next panel, “Clock Model.”</p> <div class="image-container mt-3" style="max-width: 50%; margin: 0 auto;"> <figure id="fig2"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2024-10-06/fig2.png" sizes="95vw"></source> <img src="/assets/img/posts/2024-10-06/fig2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption style="font-size: 0.9em; text-align: center;"><strong>Figure 2:</strong> Site Model tab showing the use of the bModelTest package.</figcaption> </figure> </div> <p>When we open the panel, the strict clock model is already selected. This model assumes that the clock rate evolves equally across the entire tree. However, since our matrix involves interspecific relationships, this assumption is likely not suitable. We could test how “clock-like” our data are, but that will be the subject of a future post. For now, it is advisable to choose the “optimised relaxed clock model”.</p> <p>There are two main ways to date a phylogenetic tree: either by assigning ages to the nodes, usually based on geological events or fossil records, or by specifying a clock rate—<em>i.e.</em>, informing BEAST of the nucleotide substitution rate in our matrix. While it is common practice to use a single predetermined clock rate from the literature, we will take a different, more elegant approach. Since it is unlikely that the same clock rate applies to different datasets, estimating the rate is more appropriate. However, to ensure plausible results and aid the analysis in converging, it is recommended to introduce a narrow prior. But how do we do that?</p> <p>According to <a href="https://doi.org/10.1017/CBO9781139095112" rel="external nofollow noopener" target="_blank">Drummond &amp; Bouckaert (2015)</a>, if “a number of independent rate estimates from other papers on relevant taxa and gene regions” are available, one can fit a log-normal distribution to these values and use them as a prior. Since several estimates for the 16S gene in frogs are available in the literature (see <a href="https://doi.org/10.1111/j.1558-5646.2007.00181.x" rel="external nofollow noopener" target="_blank">Lemmon et al., 2007</a>, <a href="https://doi.org/10.1093/sysbio/syr130" rel="external nofollow noopener" target="_blank">Fouquet et al., 2012</a>, <a href="https://doi.org/10.1016/j.ympev.2017.04.007" rel="external nofollow noopener" target="_blank">Gehara et al., 2017</a>, and <a href="https://doi.org/10.1080/14772000.2022.2102686" rel="external nofollow noopener" target="_blank">Dufresnes et al., 2022</a>), we will follow this approach. All we need is <a href="https://www.R-project.org/" rel="external nofollow noopener" target="_blank">R</a> (R Core Team, 2024) and a small piece of code:</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">fitdistrplus</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span><span class="w">

</span><span class="n">rate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.006</span><span class="p">,</span><span class="w"> </span><span class="m">0.00555</span><span class="p">,</span><span class="w"> </span><span class="m">0.00277</span><span class="p">,</span><span class="w"> </span><span class="m">0.005</span><span class="p">)</span><span class="w">  </span><span class="c1"># Define a vector of rates</span><span class="w">
</span><span class="n">ratedist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fitdist</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span><span class="w"> </span><span class="s2">"lnorm"</span><span class="p">)</span><span class="w">  </span><span class="c1"># Fit a log-normal distribution to the rate data</span><span class="w">

</span><span class="n">mean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span><span class="w">  </span><span class="c1"># Calculate the mean of the rates, it will be useful as a starting point</span><span class="w">
</span><span class="n">log.mean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unname</span><span class="p">(</span><span class="n">ratedist</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="s2">"meanlog"</span><span class="p">])</span><span class="w">  </span><span class="c1"># Get the estimated mean value from the fitted lognormal distribution</span><span class="w">
</span><span class="n">log.sd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unname</span><span class="p">(</span><span class="n">ratedist</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="s2">"sdlog"</span><span class="p">])</span><span class="w">  </span><span class="c1"># Get the estimated sd value from the fitted lognormal distribution</span><span class="w">
</span></code></pre></div></div> <p>In our case, the mean of the log-normal distribution is -5.374295 and the sd is 0.304072. We will use hese values in the “Priors” panel shortly. For now, let’s use the mean of our four rate values, 0.00483, as a starting point to help the Markov chains converge (<a href="#fig3">Fig. 3</a>). <strong>Do not forget to check the “estimate” box</strong>. To do this, navigate to <code>Mode</code> and uncheck the <code>Automatic set clock rate</code> option.</p> <div class="image-container mt-3" style="max-width: 50%; margin: 0 auto;"> <figure id="fig3"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2024-10-06/fig3.png" sizes="95vw"></source> <img src="/assets/img/posts/2024-10-06/fig3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption style="font-size: 0.9em; text-align: center;"><strong>Figure 3:</strong> Clock Model panel showing the chosen model, Optimised Relaxed Clock, and the starting value of the <code>clock.rate</code> prior.</figcaption> </figure> </div> <p>Moving on to the “Priors” panel, we will see several parameters. We will leave most of them under default, but we will change the tree and the molecular clock priors. The current tree prior, “Yule”, has only one parameter to be estimated, the birth rate, assuming no extinction events. A more appropriate prior would be the Birth Death Model (<a href="#fig4">Fig. 4</a>), which does account for extinction.</p> <div class="image-container mt-3"> <figure id="fig4"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2024-10-06/fig4.png" sizes="95vw"></source> <img src="/assets/img/posts/2024-10-06/fig4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption style="font-size: 0.9em; text-align: center;"><strong>Figure 4:</strong> Priors panel, showing the changes in tree and ORCucldMean models.</figcaption> </figure> </div> <p>Finally, we are going now to use the mean and standard deviation we calculated from our log-normal model. Open the <code>ORCucldMean.c</code> prior and add the meanlog value (in our case, -5.374295) to the M parameter and sdlog (0.304072) to S (<a href="#fig4">Fig. 4</a>). To make sure, you can plot your log-normal model and compare it to the one in BEAUti (<a href="#fig5">Fig. 5</a>):</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w">  </span><span class="c1"># Create a sequence of values from 0 to 0.01 with 100 points</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dlnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">meanlog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log.mean</span><span class="p">,</span><span class="w"> </span><span class="n">sdlog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log.sd</span><span class="p">)</span><span class="w">  </span><span class="c1"># Calculate the density of the log-normal distribution for the x values</span><span class="w">

</span><span class="c1"># Set up the graphics device to save the plot as a PNG file</span><span class="w">
</span><span class="n">png</span><span class="p">(</span><span class="s2">"your_path.png"</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"mm"</span><span class="p">,</span><span class="w">
    </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="n">pointsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plot the density curve of the log-normal distribution</span><span class="w">
</span><span class="n">curve</span><span class="p">(</span><span class="n">dlnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">meanlog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log.mean</span><span class="p">,</span><span class="w"> </span><span class="n">sdlog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log.sd</span><span class="p">),</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Probability density"</span><span class="p">,</span><span class="w">
      </span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.001</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Clock rate"</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="c1"># Add a filled polygon under the density curve</span><span class="w">
</span><span class="n">polygon</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">rev</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">))),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rgb</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span><span class="w">

</span><span class="n">dev.off</span><span class="p">()</span><span class="w">  </span><span class="c1"># Close the graphics device</span><span class="w">
</span></code></pre></div></div> <div class="image-container mt-3" style="max-width: 50%; margin: 0 auto;"> <figure id="fig5"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2024-10-06/fig5.png" sizes="95vw"></source> <img src="/assets/img/posts/2024-10-06/fig5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption style="font-size: 0.9em; text-align: center;"><strong>Figure 5:</strong> Plot of the fitted log-normal model</figcaption> </figure> </div> <p>We will leave the MCMC panel unchanged. If your dataset is larger, you may want to consider increasing the number of generations, but for our matrix, 10 million generations with sampling every 1,000 generations should be sufficient.</p> <h3>Results</h3> <p>We will use <a href="https://github.com/beast-dev/tracer/releases/latest" rel="external nofollow noopener" target="_blank">Tracer</a> (<a href="https://academic.oup.com/sysbio/article/67/5/901/4989127" rel="external nofollow noopener" target="_blank">Rambaut et al., 2018</a>) to assess the convergence of the MCMC output. Ideally, all ESS values should exceed 200. When conducting the final analysis, you should run at least one additional replicate, starting from a different seed, to ensure that the MCMC has fully converged.</p> <p>To check our analysis, click the “+” button in the top left corner and load the <code>.log</code> file generated by BEAST. As shown in <a href="#fig6">Fig. 6</a>, a chain length of 10,000,000 generations was sufficient for the MCMC output to converge.</p> <div class="image-container mt-3"> <figure id="fig6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2024-10-06/fig6.png" sizes="95vw"></source> <img src="/assets/img/posts/2024-10-06/fig6.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption style="font-size: 0.9em; text-align: center;"><strong>Figure 6:</strong> Tracer output after loading the log file.</figcaption> </figure> </div> <p>The <code>.trees</code> files generated by BEAST contain multiple trees, representing the posterior distribution from the Bayesian analysis. We will now summarize these into a Maximum Credibility Tree using another BEAST tool, <a href="https://beast2.blogs.auckland.ac.nz/treeannotator/" rel="external nofollow noopener" target="_blank">TreeAnnotator</a>. The only change I will make is regarding node heights, which I will set to “mean heights”—but feel free to use the option that best suits your analysis (<a href="#fig7">Fig. 7</a>).</p> <div class="image-container mt-3" style="max-width: 50%; margin: 0 auto;"> <figure id="fig7"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2024-10-06/fig7.png" sizes="95vw"></source> <img src="/assets/img/posts/2024-10-06/fig7.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption style="font-size: 0.9em; text-align: center;"><strong>Figure 7:</strong> TreeAnnotator window with node heights set to "mean heights".</figcaption> </figure> </div> <p>After adjusting the input to your <code>.trees</code> file and naming the output as you prefer, you can view the results using your favorite tree viewer. I hope your output looks as cool as mine (<a href="#fig8">Fig. 8</a>)!</p> <div class="image-container mt-3"> <figure id="fig8"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/2024-10-06/fig8.png" sizes="95vw"></source> <img src="/assets/img/posts/2024-10-06/fig8.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figcaption style="font-size: 0.9em; text-align: center;"><strong>Figure 8:</strong> Chronogram of 16S showing the relationships within *Pristimantis* species.</figcaption> </figure> </div> <h3>References</h3> <p>Bouckaert, R., &amp; Drummond, A. J. (2017). bModelTest: Bayesian phylogenetic site model averaging and model comparison. <em>BMC Evolutionary Biology</em>, <strong>17</strong>(1), 42.</p> <p>Bouckaert, R., Vaughan, T. G., Barido-Sottani, J., Duchêne, S., Fourment, M., Gavryushkina, A., et al. (2019). BEAST 2.5: An advanced software platform for Bayesian evolutionary analysis. <em>PLoS Computational Biology</em>, <strong>15</strong>(4), e1006650.</p> <p>Dufresnes, C., Mahony, S., Prasad, V. K., Kamei, R. G., Masroor, R., Khan, M. A., … Litvinchuk, S. N. (2022). Shedding light on taxonomic chaos: Diversity and distribution of South Asian skipper frogs (Anura, Dicroglossidae, Euphlyctis). <em>Systematics and Biodiversity</em>, <strong>20</strong>(1), 1–25.</p> <p>Fouquet, A., Noonan, B. P., Rodrigues, M. T., Pech, N., Gilles, A., &amp; Gemmell, N. J. (2012). Multiple Quaternary refugia in the eastern Guiana Shield revealed by comparative phylogeography of 12 frog species. <em>Systematic Biology</em>, <strong>61</strong>(3), 461.</p> <p>Gehara, M., Barth, A., de Oliveira, E. F., Costa, M. A., Haddad, C. F. B., &amp; Vences, M. (2017). Model-based analyses reveal insular population diversification and cryptic frog species in the <em>Ischnocnema parva</em> complex in the Atlantic forest of Brazil. <em>Molecular Phylogenetics and Evolution</em>, <strong>112</strong>, 68–78.</p> <p>Lemmon, E. M., Lemmon, A. R., &amp; Cannatella, D. C. (2007). Geological and climatic forces driving speciation in the continentally distributed trilling chorus frogs (<em>Pseudacris</em>). <em>Evolution</em>, <strong>61</strong>, 2086–2103.</p> <p>R Core Team (2024). R: A language and environment for statistical computing. <em>R Foundation for Statistical Computing</em>, Vienna, Austria.</p> <p>Taucce, P. P. G., Nascimento, J. S., Trevisan, C. C., Leite, F. S. F., Santana, D. J., Haddad, C. F. B., &amp; Napoli, M. F. (2020). A new rupicolous species of the <em>Pristimantis conspicillatus</em> group (Anura: Brachycephaloidea: Craugastoridae) from Central Bahia, Brazil. <em>Journal of Herpetology</em>, <strong>54</strong>(2), 245–257.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Pedro P. G. Taucci. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: December 02, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-home",title:"Home",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"Blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"Publications",description:"Publications by categories in reversed chronological order. Generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"Projects",description:"Explore our collection of research initiatives and science communication projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-repositories",title:"Repositories",description:"GitHub repositories of LaBESTA and its members.",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-cv",title:"CV",description:"This is a summarized version of my CV. For publications, please go to the Publications tab, and if you&#39;d like a more complete version, click the button above.",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"nav-teaching",title:"Teaching",description:"Materials for undergraduate and graduate courses taught.",section:"Navigation",handler:()=>{window.location.href="/teaching/"}},{id:"nav-people",title:"People",description:"Members of LaBESTA",section:"Navigation",handler:()=>{window.location.href="/people/"}},{id:"post-building-a-calibrated-gene-tree-with-beast-2-7",title:"Building a calibrated gene tree with BEAST 2.7",description:"A step-by-step beginner&#39;s guide",section:"Posts",handler:()=>{window.location.href="/blog/2024/calibrated_gene_tree/"}},{id:"news-we-just-arrived-to-s\xe3o-paulo-state-university-unesp-at-bauru-s\xe3o-paulo",title:"We just arrived to S\xe3o Paulo State University (Unesp) at Bauru, S\xe3o Paulo!...",description:"",section:"News"},{id:"projects-drag\xf5es-de-garagem",title:"Drag\xf5es de Garagem",description:"Bringing science to the public through engaging discussions and accessible content as part of one of Brazil\u2019s top science outreach podcasts",section:"Projects",handler:()=>{window.location.href="/projects/DdG/"}},{id:"projects-systematics-of-ischnocnema",title:"Systematics of Ischnocnema",description:"Taxonomic review and molecular phylogenetics of the Neotropical frog genus Ischnocnema (Anura: Brachycephaloidea)",section:"Projects",handler:()=>{window.location.href="/projects/systematics_of_ischnocnema/"}},{id:"teaching-taxonomia-integrativa",title:"Taxonomia Integrativa",description:"Material da disciplina Taxonomia Integrativa",section:"Teaching",handler:()=>{window.location.href="/teaching/taxonomia_integrativa/"}},{id:"teaching-vertebrados-ii",title:"Vertebrados II",description:"Material da disciplina de Vertebrados II, Unesp Bauru",section:"Teaching",handler:()=>{window.location.href="/teaching/vertebrados2/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%70%65%64%72%6F.%74%61%75%63%63%69@%75%6E%65%73%70.%62%72","_blank")}},{id:"socials-orcid",title:"ORCID",section:"Socials",handler:()=>{window.open("https://orcid.org/0000-0002-3088-4543","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=67gGXtMAAAAJ","_blank")}},{id:"socials-lattes",title:"Lattes",section:"Socials",handler:()=>{window.open("http://lattes.cnpq.br/6010051338306653","_blank")}},{id:"socials-researchgate",title:"ResearchGate",section:"Socials",handler:()=>{window.open("https://www.researchgate.net/profile/Pedro-Taucce/","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/labesta","_blank")}},{id:"socials-x",title:"X",description:"Twitter",section:"Socials",handler:()=>{window.open("https://twitter.com/pedrotaucce","_blank")}},{id:"socials-instagram",title:"Instagram",section:"Socials",handler:()=>{window.open("https://instagram.com/labesta_unesp","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>